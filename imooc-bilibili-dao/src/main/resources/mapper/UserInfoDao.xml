<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.imooc.dao.UserInfoDao">

    <insert id="addUserInfo" parameterType="com.imooc.domain.UserInfo">
        insert into t_user_info(userId, nick, avatar,sign, gender, birth, createTime, updateTime)
            VALUES(#{userId},#{nick},#{avatar},#{sign},#{gender},#{birth},#{createTime},#{updateTime})
    </insert>

    <update id="updateUserInfos" parameterType="com.imooc.domain.UserInfo">
        update
            t_user_info
        set
            <if test="nick !=null and nick != ''">
                nick=#{nick}
            </if>
            <if test="avatar != null">
                avatar=#{avatar}
            </if>
            <if test="sign != null">
                sign=#{sign}
            </if>
            <if test="birth != null and birth != ''">
                birth=#{birth}
            </if>
            <if test="gender != null and gender !=''">
                gender=#{gender}
            </if>
            updateTime=#{updateTime}
        where
            userId=#{userId}
    </update>

    <select id="getUserInfoByUserId" parameterType="java.lang.Long" resultType="com.imooc.domain.UserInfo">
        select * from t_user_info where userId=#{userId}
    </select>

    <select id="getUserInfoByUserIds" resultType="com.imooc.domain.UserInfo">
        select * from t_user_info
        where
            1=1
            <if test="ids != null and ids.size > 0">
                and userId in
                <foreach collection="ids" item="id" separator="," open="(" close=")">
                    #{id}
                </foreach>
            </if>
            <if test="ids == null or ids.size == 0">
                and 1=2
            </if>
    </select>

    <select id="pageCountUserInfos" resultType="java.lang.Integer" parameterType="java.util.Map">
        select count(1) from t_user_info where 1=1
            <if test="nick != null and nick != ''">
                and nick like '%${nick}%'
            </if>
    </select>

    <select id="pageListUserInfos" resultType="com.imooc.domain.UserInfo">
        select * from t_user_info where 1=1
        <if test="nick != null and nick != ''">
            and nick like '%${nick}%'
        </if>
        order by id desc
        limit #{start},#{limit}
    </select>

</mapper>